
### 1. set & nx 

```redis

set lockKey 1 ex 10 nx

```


>  没有会返回 1 ：设置成功  
>  已存在返回 0 : 设置失败 

#### **优点：简单**
#### **缺点** 

1. **死锁问题**： 如未设置过期时间，锁忘记删了或加锁线程宕机都会导致死锁，也就是分布式锁一直被占用的情况。
2. **锁误删问题**： 设置了超时时间，但因为执行时间太长，所以在超时时间之内锁已经被自动释放了，但线程不知道，因此在线程执行结束之后，会把其他线程的锁误删的问题。
3. **不可重入问题**：也就是说同一线程在已经获取了某个锁的情况下，如果再次请求获取该锁，则请求会失败（因为只有在第一次能加锁成功）。也就是说，一个线程不能对自己已持有的锁进行重复锁定。
4. **无法自动续期**：线程在持有锁期间，任务未能执行完成，锁可能会因为超时而自动释放。 无法自动根据任务的执行情况，设置新的超时实现，以延长锁的时间。

### 2.  [redissonlock](redisson#Redisson使用分布式锁)